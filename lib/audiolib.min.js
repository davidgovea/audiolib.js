this.audioLib=(function AUDIOLIB(x,k,B,q){var t=x.Float32Array||q,e=this;function d(G){var H=new t(G);H.subarray=H.subarray||H.slice;return H}e.Float32Array=d;var D=(function(){if(B.defineProperty){return B.defineProperty}else{if(B.prototype.__defineGetter__){return function(G,I,H){H.get&&G.__defineGetter__(I,H.get);H.set&&G.__defineSetter__(I,H.set)}}}}());function l(I,J,H,G){if(D){D(I,J,{get:function(){return H},enumerable:!!G})}else{I[J]=H}}l(e,"__define",D);l(e,"__defineConst",l);function u(J){var H=arguments,G=H.length,I,K;for(I=1;I<G;I++){for(K in H[I]){if(H[I].hasOwnProperty(K)){J[K]=H[I][K]}}}return J}l(e,"__extend",u);function r(H,J,I){var G;for(G in H){(H.hasOwnProperty(G)||I)&&J.call(H,H[G],G)}return H}l(e,"__enum",r);function A(L,H,I,M,K){this.attack=H||50;this.decay=I||50;this.sustain=M||1;this.release=K||50;this.value=0;var O=this,G=3,J=false,N=[function(){O.value+=1000/O.sampleRate/O.attack;if(O.value>=1){G=1}},function(){O.value-=1000/O.sampleRate/O.decay*O.sustain;if(O.value<=O.sustain){G=2}},function(){O.value=O.sustain},function(){O.value=k.max(0,O.value-1000/O.sampleRate/O.release)}];this.generate=function(){N[G]();return this.value};this.triggerGate=function(P){J=P;G=J?0:3};this.sampleRate=L}function E(){var O=this,L=[];this.velocity=0;this.legato=0;this.retrigger=0;this.polyphony=1;this.activeKeys=[];this.voices=[];this.pitchBend=0;function M(P,Q){this.key=P;this.velocity=Q;this.noteOff=function(){};this.onKeyChange=function(){};this.changeKey=function(S,R){this.key=S;this.v=R;this.onKeyChange()};this.getFrequency=function(){return O.getFrequencyForKey(this.key)};O.voice.apply(this)}function J(Q){var P;for(P=0;P<L.length;P++){if(L[P].key===Q){L.splice(P--,1)}}}function N(P,Q){J(P);L.push({key:P,velocity:Q})}function H(){var P,R,Q=[];if(O.legato===0){Q=L.slice(0)}else{if(O.legato===1){for(P=0;P<L.length;P++){for(R=0;R<Q.length;R++){if(R===L.length-1||(Q[R-1].key>L[P].key&&Q[R].key<L[P].key)){Q.splice(R,0,L[P]);break}}}}else{if(O.legato===2){for(P=0;P<L.length;P++){for(R=0;R<Q.length;R++){if(R===L.length-1||(Q[R-1].key<L[P].key&&Q[R].key>L[P].key)){Q.splice(R,0,L[P]);break}}}}}}O.activeKeys=Q.slice(-O.polyphony)}function G(){if(!O.voice){return}var P,R,Q;if(O.polyphony===1&&O.activeKeys.length>0){P=O.activeKeys.length-1;if(O.voices.length===0){O.voices.push(new M(O.activeKeys[P].key,O.activeKeys[P].velocity))}else{O.voices[0].changeKey(O.activeKeys[P].key,O.activeKeys[P].velocity)}}else{for(R=0;R<O.activeKeys.length;R++){Q=false;for(P=0;P<O.voices.length;P++){if(O.voices[P].key===O.activeKeys[R].key){Q=true;break}}if(!Q){O.voices.push(new M(O.activeKeys[P].key,O.activeKeys[P].velocity))}}}for(P=0;P<O.voices.length;P++){Q=false;for(R=0;R<O.activeKeys.length;R++){if(O.voices[P].key===O.activeKeys[R].key){Q=true;break}}if(!Q){O.voices[P].noteOff();O.voices.splice(P--,1)}}}function K(Q,R){var P=O.activeKeys.length;N(Q,R);H();G();O.onNoteOn(Q,R);if(O.retrigger===0||(P===0&&O.activeKeys.length>0)){O.onTrigger()}}function I(P,Q){J(P,Q);H();G();O.onNoteOff(P,Q);if(O.activeKeys===0){O.onRelease()}}this.onMidi=function(P){switch(P.status){case 9:K(P.data1,P.data2/127);break;case 8:I(P.data1,P.data2/127);break;case 14:O.pitchBend=(P.data1*128+P.data2-8192)/8192;break}};this.getFrequencyForKey=function(P){return 440*k.pow(1.059,P-69)};this.getFrequency=function(){var Q=[],P;for(P=0;P<O.activeKeys.length;P++){Q.push(O.getFrequencyForKey(O.activeKeys[P].key))}if(Q.length>2){return Q[0]}return Q};this.onTrigger=function(){};this.onRelease=function(){};this.onNoteOn=function(){};this.onNoteOff=function(){};this.voice=null;this.listener=function(P){O.onMidi(P)}}function y(K,H,J,L){var I=this,G=0;I.sampleRate=K;I.stepLength=H||200;I.steps=J||[1,0];I.value=0;I.attack=L||0;I.generate=function(){var O=I.sampleRate/1000*I.stepLength,Q=I.steps,P=O*Q.length,S,M,N,R,T;if(++G===P){G=0}S=G/P*Q.length;M=S%1;S=k.floor(S);N=(S||Q.length)-1;R=Q[S]-Q[N];T=Q[S];if(M<I.attack){T-=R-R/I.attack*M}I.value=T;return T};I.triggerGate=function(){G=0}}function s(O,G,J,K){var P=this,I=new d(G),H=G-1,M=J,N=0,L=0;this.volume=P.volume||1;P.sampleRate=O;P.pushSample=function(Q){I[M++]=Q;L=I[N++]*P.volume;if(M>=H){M=0}if(N>=H){N=0}return L};P.getMix=function(){return L}}function F(H,J){var G=this,I=0;G.sampleRate=H;G.resolution=J?k.pow(2,J-1):k.pow(2,8-1);G.pushSample=function(K){I=k.floor(K*G.resolution+0.5)/G.resolution;return I};G.getMix=function(){return I}}function w(N,K,J,G){var O=this,I,H,M;O.delayTime=K||30;O.depth=J||3;O.freq=G||0.1;function L(){I=new d(O.sampleRate*0.1);H=0;var Q,P=I.length;for(Q=0;Q<P;Q++){I[Q]=0}}O.sampleRate=N;O.osc=new c(N,G);O.calcCoeff=L;O.pushSample=function(Q){if(++H>=I.length){H=0}I[H]=Q;O.osc.generate();var P=O.delayTime+O.osc.getMix()*O.depth;P*=O.sampleRate/1000;P=H-k.floor(P);while(P<0){P+=I.length}M=I[P];return M};O.getMix=function(){return M};L()}function C(I,H,K){var G=this,J=0;G.sampleRate=I;G.scale=H||1;G.gain=K||0.5;G.pushSample=function(L){L/=G.scale;J=(1+G.gain)*L-G.gain*L*L*L;return J};G.getMix=function(){return J}}function g(I,J,G){var H=this;H.time=isNaN(J)?H.time:J;H.feedback=isNaN(J)?H.feedback:G;H.reset(I)}g.prototype={sampleRate:1,bufferPos:0,buffer:null,time:1000,feedback:0,sample:0,_rstf:1,pushSample:function(I){var H=this,G=H.buffer;G[H.bufferPos++]+=I;if(H.bufferPos>H.time*H._rstf){H.bufferPos=0}H.sample=G[H.bufferPos];G[H.bufferPos]*=H.feedback;return H.sample},getMix:function(){return this.sample},resample:function(I){var G=this,H=G.time/I;G.buffer=e.Sampler.resample(G.buffer,I);G.time=I;G.bufferPos=k.round(H*G.bufferPos);return G.buffer},reset:function(I,L){var G=this,H=G.buffer,J,K;I=isNaN(I)?G.sampleRate:I;K=G.sampleRate/I;G.buffer=new d(I*g.MAX_DELAY);G.bufferPos=k.round(K*G.bufferPos);G._rstf=1/1000*I;if(L){H=e.Sampler.resample(H,K);for(J=0;J<H.length&&J<G.buffer.length;J++){G.buffer[J]=H[J]}}return G.buffer}};g.MAX_DELAY=2;function o(G){var K=new f(G,720.484),J=new f(G,723.431),I=new f(G,1),H=0;this.gain=4;this.master=1;this.sampleRate=G;this.filters=[K,J,I];this.pushSample=function(L){K.pushSample(L);H=K.getMix(1)*this.gain;H=k.atan(H)+H;if(H>0.4){H=0.4}else{if(H<-0.4){H=-0.4}}J.pushSample(H);I.pushSample(J.getMix(0));H=I.getMix(1)*this.master;return H};this.getMix=function(){return H}}(function(H,G){G.Capper=function(J,K){var I=this,L=0;I.sampleRate=J;I.cap=K||1;I.pushSample=function(M){L=M>I.cap?2*I.cap-M:M<-I.cap?-2*I.cap-M:M;return L};I.getMix=function(){return L}};G.Expo=function(J,L){var I=this,K=0;I.sampleRate=J;I.param=L||0.8;I.pushSample=function(M){K=(M<0?-k.pow(I.param*2,-M):k.pow(I.param*2,M))/10;return K};I.getMix=function(){return K}}}(this,e));function f(L,H,S,Q){var T=this,N=[0,0,0,0],G,J,R,I,P=k.sin,K=k.min,M=k.pow;T.cutoff=!H?20000:H;T.resonance=!S?0.1:S;T.samplerate=L;T.type=Q||0;function O(){G=2*P(k.PI*K(0.25,T.cutoff/(T.samplerate*2)));J=K(2*(1-M(T.resonance,0.25)),K(2,2/G-G*0.5))}T.pushSample=function(U){if(R!==T.cutoff||I!==T.resonance){O();R=T.cutoff;I=T.resonance}N[3]=U-J*N[2];N[0]=N[0]+G*N[2];N[1]=N[3]-N[0];N[2]=G*N[1]+N[2];N[3]=U-J*N[2];N[0]=N[0]+G*N[2];N[1]=N[3]-N[0];N[2]=G*N[1]+N[2];return N[T.type]};T.getMix=function(U){return N[U||T.type]}}function a(I,J,K){var G=this,H=[0,0];G.cutoff=!J?20000:J;G.resonance=!K?0:K;G.samplerate=I;G.pushSample=function(M){var L=G.cutoff*2/G.samplerate,N=G.resonance+G.resonance/(1-L);H[0]=H[0]+L*(M-H[0]+N*(H[0]-H[1]));H[1]=H[1]+L*(H[0]-H[1]);return H[1]};G.getMix=function(){return H[1]}}function v(L,I,S){var T=this,Q=0,K=0,N=k.PI*2,P,H,G,O,R,J;T.cutoff=!I?20000:I;T.resonance=!S?1:S;T.samplerate=L;function M(){P=N*T.cutoff/T.samplerate;H=1-P/(2*(T.resonance+0.5/(1+P))+P-2);G=H*H;O=G+1-2*k.cos(P)*H}T.pushSample=function(U){if(R!==T.cutoff||J!==T.resonance){M();R=T.cutoff;J=T.resonance}Q+=(U-K)*O;K+=Q;Q*=G;return K};T.getMix=function(){return K};M()}function c(H,I){var G=this;G.frequency=isNaN(I)?440:I;G.waveTable=new d(1);G.sampleRate=H;G.waveShapes=G.waveShapes.slice(0)}(function(I,J,H,G){H=c.prototype={sampleRate:1,frequency:440,phase:0,phaseOffset:0,pulseWidth:0.5,fm:0,waveShape:"sine",_p:0,generate:function(){var K=this,M=+K.frequency,L=K.pulseWidth,N=K.phase;M+=M*K.fm;K.phase=(N+M/K.sampleRate/2)%1;N=(K.phase+K.phaseOffset)%1;K._p=N<L?N/L:(N-L)/(1-L)},getMix:function(){return this[this.waveShape]()},getPhase:function(){return this._p},reset:function(K){this.phase=this._p=isNaN(K)?0:K},setWavetable:function(K){this.waveTable=K;return true},sine:function(){return k.sin(this._p*I)},triangle:function(){return this._p<0.5?4*this._p-1:3-4*this._p},square:function(){return this._p<0.5?-1:1},sawtooth:function(){return 1-this._p*2},invSawtooth:function(){return this._p*2-1},pulse:function(){return this._p<0.5?this._p<0.25?this._p*8-1:1-(this._p-0.25)*8:-1},wavetable:function(){return e.Sampler.interpolate(this.wavetable,this._p*this.wavetable.length)},waveShapes:[]};for(G=0;G<J.length;G++){H[G]=H[J[G]];H.waveShapes.push(H[G])}c.WaveShape=function(L,K){if(K){this.prototype[L]=K}return this.prototype[L]};c.createMixWave=function(L,O){var K=O.length,N,M;return this.WaveShape(L,function(){N=0;for(M=0;M<K;M++){N+=this[O[M].shape]()*O[M].mix}return mix})}}(k.PI*2,["sine","triangle","pulse","sawtooth","invSawtooth","square"]));function b(H,I){var G=this;G.voices=[];G.sampleRate=H;G.pitch=isNaN(I)?440:G.pitch}b.prototype={sampleRate:1,pitch:440,delayStart:0,delayEnd:0,maxVoices:1/0,sampleSize:0,voices:null,sample:null,samples:null,data:null,noteOn:function(L){L=isNaN(L)?this.pitch:L;var H=this,K=L/H.pitch,J=H.sampleRate,M=J*H.delayStart,G=H.sampleSize-J*H.delayEnd,I={f:L,p:M,s:K,l:G};H.voices.push(I);while(H.voices.length>H.maxVoices){G=H.voices.shift();G.onend&&G.onend()}return I},generate:function(){var G=this.voices,H,I;for(H=0;H<G.length;H++){I=G[H];I.p+=I.s;I.p>I.l&&G.splice(H--,1)&&I.onend&&I.onend()}},getMix:function(J){var G=this.voices,I=0,H;J=J||0;if(this.samples[J]){for(H=0;H<G.length;H++){I+=b.interpolate(this.samples[J],G[H].p)}}return I},load:function(K,J){var G=this,H=G.samples=b.splitChannels(K.data,K.channelCount),I;if(J){for(I=0;I<H.length;I++){H[I]=b.resample(H[I],K.sampleRate,G.sampleRate)}}G.sample=K.data;G.samples=H;G.data=K;G.sampleSize=H[0].length}};(function(){function G(H,I){if(H&&I){G[H]=I}else{if(H&&G[H] instanceof Function){b.interpolate=G[H]}}return G[H]}b.interpolation=G;G("linear",function(H,L){var K=k.floor(L),J=K+1,I=L-K;J=J<H.length?J:0;return H[K]*(1-I)+H[J]*I});G("nearest",function(H,I){return I>=H.length-0.5?H[0]:H[k.round(I)]});G("linear")}());b.resample=function(N,G,Q,R,I){var M=arguments.length,K=M===2?G:M===3?R/Q:R/G*I/Q,L=N.length,H=k.ceil(L/K),P=new d(H),O,J;for(O=0,J=0;O<L;O+=K){P[J++]=b.interpolate(N,O)}return P};b.splitChannels=function(H,L){var G=H.length,K=G/L,I=[],J,M;for(J=0;J<L;J++){I[J]=new d(K);for(M=0;M<K;M++){I[J][M]=H[J*L+M]}}return I};b.joinChannels=function(I){var K=I.length,H=I[0].length,G=new d(H*K),J,L;for(J=0;J<K;J++){for(L=0;L<H;L++){G[J+L*K]=I[J][L]}}return G};function z(I,J,H){var G=this;G.notes=[];G.sampleRate=I;G.noteTime=isNaN(J)?250:J;G.noteLength=I*0.001*G.noteTime;G.zero=new d(G.noteLength);G.cb=H}z.prototype={pos:0,looping:false,generate:function(){var G=this,I,H;if((G.pos+=1)===G.noteLength){I=G.notes,H=I.shift();if(G.looping){I.push(H)}G.pos=0;G.cb()}},getMix:function(){var G=this,H=G.notes[0]||G.zero;return H[G.pos]},addNote:function(H){var G=this,K=G.noteLength,J=new d(K),I=0;for(I=0;I<K;I++){J[I]=H(I)}G.notes.push(J)},getNoteLength:function(){return this.noteLength},getNoteCount:function(){return this.notes.length-1},setLooping:function(G){this.looping=(typeof G==="undefined")?true:G},reset:function(){this.notes=[];this.pos=0}};(function(G){function L(S){var U,T=S.length,R={};for(U=0;U<T;U++){R[S[U]]=true}return R}var O=L([256,512,1024,2048,4096,8192,16384]),H=L([48000,44100,22050]),Q=String.fromCharCode;function P(W,V,U,T){var S=P.devices,R;for(R in S){if(S.hasOwnProperty(R)&&S[R].enabled){try{return new S[R](W,V,U,T)}catch(X){}}}throw"No audio device available."}function I(R){this.boundTo=R;this.buffers=[];R.activeRecordings.push(this)}I.prototype={add:function(R){this.buffers.push(R)},clear:function(){this.buffers=[]},stop:function(){var R=this.boundTo.activeRecordings,S;for(S=0;S<R.length;S++){if(R[S]===this){R.splice(S--,1)}}},join:function(){var V=0,W=0,T=this.buffers,R,X,U,S=T.length;for(U=0;U<S;U++){V+=T[U].length}R=new d(V);for(U=0;U<S;U++){for(X=0;X<T[U].length;X++){R[W+X]=T[U][X]}W+=T[U].length}return R}};function N(R){this.type=R}N.prototype={record:function(){return new I(this)},recordData:function(S){var U=this.activeRecordings,T,R=U.length;for(T=0;T<R;T++){U[T].add(S)}},writeBuffers:function(T){var S=this.buffers,R=T.length,U,W,V,X;if(S){for(V=0;V<S.length;V++){U=S[V];W=U.length;for(X=0;X<R&&X<W;X++){T[X]+=U[X]}S[V]=U.subarray(X);V>=W&&S.splice(V--,1)}}},writeBuffer:function(S){var R=this.buffers=this.buffers||[];R.push(S);return R.length}};function M(ab,Y,S,ad){ad=H[ad]?ad:44100;S=O[S]?S:ad/2;var af=this,U=0,ac=null,aa=new Audio(),Z,X,W,V,R;function ae(al,ah){var ak,aj,ag;if(M.backgroundWork){if(window.MozBlobBuilder){ag=new MozBlobBuilder();ag.append('setInterval(function(){ postMessage("tic"); }, '+ah+");");aj=window.URL.createObjectURL(ag.getBlob());ak=new Worker(aj);ak.onmessage=function(){al()};return function(){ak.terminate();window.URL.revokeObjectURL(aj)}}aj=ag=+new Date+"";function ai(am){if(am.source===window&&am.data===aj&&ag<+new Date){ag=+new Date+ah;al()}window.postMessage(aj,"*")}window.addEventListener("message",ai,true);window.postMessage(aj,"*");return function(){window.removeEventListener("message",ai)}}else{ak=setInterval(al,ah);return function(){clearInterval(ak)}}}function T(){if(ac){Z=aa.mozWriteAudio(ac);U+=Z;if(Z<ac.length){ac=ac.subarray(Z);return ac}ac=null}X=aa.mozCurrentSampleOffset();W=Number(X+S*Y-U)+0;if(W>0){V=new d(W);ab&&ab(V,af.channelCount);af.writeBuffers(V);af.recordData(V);Z=aa.mozWriteAudio(V);if(Z<V.length){ac=V.subarray(Z)}U+=Z}}aa.mozSetup(Y,ad);R=ae(T,20);this.kill=function(){R()};this.activeRecordings=[];this.sampleRate=ad;this.channelCount=Y;this.type="moz"}M.enabled=true;M.backgroundWork=false;M.prototype=new N("moz");function K(Y,W,U,T){T=H[T]?T:44100;U=O[U]?U:4096;var R=this,V=new (window.AudioContext||webkitAudioContext)(),X=V.createJavaScriptNode(U,0,W);function S(ag){var Z=ag.outputBuffer,ac=Z.numberOfChannels,ae,ab,ad=Z.length,ah=Z.size,af=new q(ac),aa=new d(ad*ac);for(ae=0;ae<ac;ae++){af[ae]=Z.getChannelData(ae)}Y&&Y(aa,ac);R.writeBuffers(aa);R.recordData(aa);for(ae=0;ae<ad;ae++){for(ab=0;ab<ac;ab++){af[ab][ae]=aa[ae*ac+ab]}}}X.onaudioprocess=S;X.connect(V.destination);this.kill=function(){};this.activeRecordings=[];this.sampleRate=V.sampleRate;this.channelCount=W;this._context=V;this._node=X;this._callback=S;this.type="webkit"}K.enabled=true;K.prototype=new N("webkit");function J(W,V,U,T){T=H[T]?T:44100;U=O[U]?bufferSize:8192;var R=this,X;function S(){var Y=new d(U*V);W&&W(Y,R.channelCount);R.writeBuffers(Y);R.recordData(Y)}this.kill=function(){clearInterval(X)};this.activeRecordings=[];setInterval(S,U/T*1000);this.sampleRate=T;this.channelCount=V;this.type="dummy"}J.enabled=true;J.prototype=new N("dummy");P.deviceClass=N;P.propertyEnum=L;P.devices={moz:M,webkit:K,dummy:J};P.Recording=I;G.AudioDevice=P}(this));this.AudioDevice.createScheduled=function(K){var J=[],G=0,H;function I(M,P){var L=M.length/P,S=H.chunkSize,O=S*P,R,N,Q;G=+new Date;for(N=0;N<L;N+=S){for(R=0;R<J.length;R++){J[R].t-=S;if(J[R].t<=0){J[R].f.apply(J[R].x,J[R].a);J.splice(R--,1)}}Q=N*O;K(M.subarray(Q,Q+O),P)}}H=this.apply(this,[I].concat(q.prototype.splice.call(arguments,1)));H.schedule=function(N,M,L){J.push({f:N,x:M,a:L,t:((new Date-G)*0.001*this.sampleRate)})};H.chunkSize=1;return H};(function(){function G(){var I=arguments,H=I.length,K,J;for(J=0;J<H;J++){K=I[J];this.postMessage({type:"injection",code:K instanceof Function?"("+String(K)+").call(this);":K})}}e.AudioWorker=function(J,L){var H=new (window.MozBlobBuilder||window.BlobBuilder)(),I,K;H.append("var audioLib = ("+String(AUDIOLIB)+"(this, Math));\n");L&&H.append('this.addEventListener("message",function(e){e.data&&e.data.type==="injection"&&Function(e.data.code).call(this)}, true);\n');H.append(J instanceof Function?"("+String(J)+").call(this);":J);I=window.URL.createObjectURL(H.getBlob());K=new Worker(I);K._terminate=K.terminate;K.terminate=function(){window.URL.revokeObjectURL(id);return K._terminate.call(K,arguments)};if(L){K.inject=G}return K}}());(function(H,I){var P=String.fromCharCode,N=true,J=false;function K(Q,R){return R?P(Q&255)+K(Q>>8,R-1):""}function M(Q,R){return R?M(Q>>8,R-1)+P(255-Q&255):""}function O(Q,R,S){return S?M(Q,R):K(Q,R)}function G(V,U){var Q=V.length,T=Q-1,W=0,S=I.pow,R;if(U){for(R=0;R<Q;R++){W+=(255-V.charCodeAt(R))*S(256,T-R)}}else{for(R=0;R<Q;R++){W+=V.charCodeAt(R)*S(256,R)}}return W}function L(U,Z,T,ac){var Y=I.pow,X=I.floor,R=L.convertFromBinary,aa=L.convertToBinary,Q=U/8,W=Y(2,U),ab=W/2,ad=ab-1,V=1/ab,S=1/ad;return ac?T?Z?function(ae,af){ae=X(ae<0?ae*ab+W:ae*ad);return aa(ae,Q,af)}:function(ae,af){return aa(X(ae*ad),Q,af)}:Z?function(ae,af){return aa(ae<0?ae+W:ae,Q,af)}:function(ae,af){return aa(ae,Q,af)}:T?Z?function(ag,af){var ae=R(ag,af);return ae>ad?(ae-W)*V:ae*S}:function(af,ae){return R(af,ae)*S}:Z?function(ag,af){var ae=R(ag,af);return ae>ad?ae-W:ae}:function(af,ae){return R(af,ae)}}L.convertToBinary=O;L.convertFromBinary=G;L.fromFloat32=L(32,N,N,N);L.toFloat32=L(32,N,N,J);L.fromFloat24=L(24,N,N,N);L.toFloat24=L(24,N,N,J);L.fromFloat16=L(16,N,N,N);L.toFloat16=L(16,N,N,J);L.fromFloat8=L(8,N,N,N);L.toFloat8=L(8,N,N,J);L.fromInt32=L(32,N,J,N);L.toInt32=L(32,N,J,J);L.fromInt16=L(16,N,J,N);L.toInt16=L(16,N,J,J);L.fromInt8=L(8,N,J,N);L.toInt8=L(8,N,J,J);L.fromUint32=L(32,J,J,N);L.toUint32=L(32,J,J,J);L.fromUint16=L(16,J,J,N);L.toUint16=L(16,J,J,J);L.fromUint8=L(8,J,J,N);L.toUint8=L(8,J,J,J);H.Binary=L}(this,k));(function(K,L){function M(N){this.data=N}var J=M.prototype={read:function(O){var N=this,P=N.data.substr(0,O);N.skip(O);return P},skip:function(O){var N=this,P=N.data=N.data.substr(O);N.pointer+=O;return P.length},readBuffer:function(O,R,T){var P=this,S="read"+T+R,U=R/8,N=O.length,Q=0;while(P.data&&Q<N){O[Q++]=P[S]()}return Q}},I,H;function G(Q,O,P){var N=O/8;J["read"+Q+O]=function(R){return P(this.read(N),R)}}for(I in L){H=/to([a-z]+)([0-9]+)/i.exec(I);H&&G(H[1],H[2],L[I])}K.Stream=M;M.newType=G}(this,this.Binary));this.PCMData=(function(G,H){function I(J){return(typeof J==="string"?I.decode:I.encode)(J)}I.decodeFrame=function(M,L,J){if(L===8){var K=new (window.Uint8Array||q)(J.length);(new H(M)).readBuffer(K,8,"Uint");for(L=0;L<J.length;L++){J[L]=(K[L]-127.5)*127.5}}else{(new H(M)).readBuffer(J,L,"Float")}return J};I.encodeFrame=function(O,M){var K=G[(M===8?"fromUint":"fromFloat")+M],J=O.length,N="",L;if(M===8){for(L=0;L<J;L++){N+=K(O[L]*127.5+127.5)}}else{for(L=0;L<J;L++){N+=K(O[L])}}return N};I.decode=function(ai,ah){var M=new H(ai),S=M.read(4),aa=M.readUint32();M=new H(M.read(aa));var P=M.read(4),R=M.read(4),Y=M.readUint32(),J=new H(M.read(Y)),L=J.readUint16(),ad=J.readUint16(),ag=J.readUint32(),N=J.readUint32(),af=J.readUint16(),ae=af/ad,Q=J.readUint16(),K,U,W,ab,Z,O,ac,X={},T={channelCount:ad,bytesPerSample:af/ad,sampleRate:N/af,chunks:X,data:Z};function V(){K=M.read(4);U=M.readUint32();ab=M.read(U);O=X[K]=X[K]||[];if(K==="data"){W=~~(U/ae);Z=T.data=new (typeof d!=="undefined"?d:q)(W);I.decodeFrame(ab,ae*8,Z)}else{O.push(ab)}ah&&(M.data?setTimeout(V,1):ah(T))}if(ah){M.data?V():ah(T)}else{while(M.data){V()}}return T};I.encode=function(ab,Z){var V=G.fromUint32,ac=G.fromUint16,S=ab.data,J=ab.sampleRate,N=ab.channelCount||1,X=ab.bytesPerSample||1,O=X*8,L=N*X,Y=J*L,M=S.length,K=M*X,R=k.pow(2,O-1)-1,Q=[],P="",aa,W,T,U;Q.push("fmt "+V(16)+ac(1)+ac(N)+V(J)+V(Y)+ac(L)+ac(O));Q.push("data"+V(K)+I.encodeFrame(S,O));U=ab.chunks;if(U){for(W in U){if(U.hasOwnProperty(W)){aa=U[W];for(T=0;T<aa.length;T++){P=aa[T];Q.push(W+V(P.length)+P)}}}}Q=Q.join("");Q="RIFF"+V(Q.length)+"WAVE"+Q;Z&&setTimeout(function(){Z(Q)},1);return Q};return I}(this.Binary,this.Stream));(function(H,I){var O=I.sin,S=I.cos,R=I.sqrt,M=I.floor,N=I.pow,G=I.ln2,L=I.PI,K=L*2;function J(U,T,V){U.sampleRate=T;U.bufferSize=V;U.bandWidth=0.5*V*T*0.5;U.spectrum=new d(V*0.5);U.real=new d(V);U.imag=new d(V);U.peakBand=U.peak=0;U.getBandFrequency=function(W){return this.bandwidth*W+this.bandwidth*0.5};U.calculateSpectrum=function(){var ag=this,ac=ag.spectrum,ad=ag.real,W=ag.imag,af=0.5*ag.bufferSize,X=R,ab=V*0.5,aa,ae,Z,Y;for(Y=0;Y<ab;Y++){aa=ad[Y];ae=W[Y];Z=af*X(aa*aa+ae*ae);if(Z>ag.peak){ag.peakBand=Y;ag.peak=Z}}}}function Q(U,T,V){return new Q[U](T,V)}function P(U,Z){var T=this,X=Z*Z*0.5,W=new d(X),Y=new d(X),V;J(T,U,Z);for(V=0;V<X;V++){W[V]=O(V*K/Z);Y[V]=S(V*K/Z)}T.forward=function(ae){var aj=this,ah=aj.real,aa=aj.imag,ag=aj.bufferSize*0.5,ac=ae.length,af,ai,ad,ab,ak;for(ad=0;ad<ag;ad++){af=ai=0;for(ab=0;ab<ac;ab++){af+=Y[ak=ad*ab]*ae[ab];ai+=W[ak]*ae[ab]}ah[ad]=af;aa[ad]=ai}return aj.calculateSpectrum()}}H.FourierTransform=Q;Q.DFT=P}(this,k));e.ADSREnvelope=A;e.MidiEventTracker=E;e.StepSequencer=y;e.AllPassFilter=s;e.BitCrusher=F;e.Chorus=w;e.Compressor=C;e.Delay=g;e.Distortion=o;e.IIRFilter=f;e.LowPassFilter=a;e.LP12Filter=v;e.Oscillator=c;e.Sampler=b;e.Tracker=z;function n(){}n.prototype={type:"effect",sink:true,source:true,mix:0.5,join:function(){return p.apply(0,[this].concat(q.prototype.splice.call(arguments,0)))}};function p(){var G=q.prototype.splice.call(arguments,0),H=G.prototype=p.prototype;for(i in H){if(H.hasOwnProperty(i)){G[i]=H[i]}}return G}(function(G){p.prototype=G;G.pushSample=function(K){var H=this,J,I;for(I=0;I<H.length;I++){J=H[I].mix;K=H[I].pushSample(K)*J+K*(1-J)}return K}}(new n()));function j(I,H,G){this.channelCount=H;this.effects=[];function J(){I.apply(this,G)}J.prototype=I.prototype;while(H--){this.effects.push(new J())}}j.prototype={mix:0.5,append:function(H){var I=this,K=I.channelCount,G=H.length,J,L;for(J=0;J<G;J+=K){for(L=0;L<K;L++){H[J+L]=I.effects[L].pushSample(H[J+L])*I.mix+H[J+L]*(1-I.mix)}}return H},join:function(){return BufferEffectChain.apply(0,[this].concat(q.prototype.splice.call(arguments,0)))}};function h(){}h.prototype={type:"generator",source:true,mix:1,append:function(H,J){var G=H.length,I,K;for(I=0;I<G;I+=J){this.generate();for(K=0;K<J;K++){H[I+K]=this.getMix(K)*this.mix}}return H}};(function(J,H){function G(K){return new e.BufferEffect(this,K,[].slice.call(arguments,1))}function I(L,M,K){if(M){K=K||M.prototype;I[L]=M;var N=M.prototype=new n();N.name=N.fxid=L;I[L].createBufferBased=G;for(L in K){if(K.hasOwnProperty(L)){N[L]=K[L]}}}return I[L]}e.effects=I;for(H=0;H<J.length;H++){I(J[H],e[J[H]],e[J[H]].prototype)}}(["AllPassFilter","BitCrusher","Chorus","Compressor","Delay","Distortion","IIRFilter","LowPassFilter","LP12Filter"]));(function(I,G){function H(K,L,J){if(L){J=J||L.prototype;H[K]=L;var M=L.prototype=new h();M.name=M.fxid=K;for(K in J){if(J.hasOwnProperty(K)){M[K]=J[K]}}}return H[K]}e.generators=H;for(G=0;G<I.length;G++){H(I[G],e[I[G]],e[I[G]].prototype)}}(["Oscillator","Sampler","Tracker"]));function m(G,H){var I=G[0].toUpperCase()+G.substr(1).toLowerCase();m[G]=H;if(H.decode){e.Sampler.prototype["load"+I]=function(J){this.load.apply(this,[m[G].decode(J)].concat([].slice.call(arguments,1)))}}if(H.encode){e.AudioDevice.Recording.prototype["to"+I]=function(J){return m[G].encode({data:this.join(),sampleRate:this.boundTo.sampleRate,channelCount:this.boundTo.channelCount,bytesPerSample:J})}}return H}m("wav",e.PCMData);e.EffectChain=p;e.EffectClass=n;e.BufferEffect=j;e.GeneratorClass=h;e.codecs=e.Codec=m;e.version="0.4.7";return e}).call(typeof exports==="undefined"?{}:this,this.window||global,Math,Object,Array);