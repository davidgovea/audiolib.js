this.audioLib=(function AUDIOLIB(y,l,C,r){var u=y.Float32Array||r,f=this;function e(H){var I=new u(H);I.subarray=I.subarray||I.slice;return I}f.Float32Array=e;var E=(function(){if(C.defineProperty){return C.defineProperty}else{if(C.prototype.__defineGetter__){return function(H,J,I){I.get&&H.__defineGetter__(J,I.get);I.set&&H.__defineSetter__(J,I.set)}}}}());function m(J,K,I,H){if(E){E(J,K,{get:function(){return I},enumerable:!!H})}else{J[K]=I}}m(f,"__define",E);m(f,"__defineConst",m);function v(K){var I=arguments,H=I.length,J,L;for(J=1;J<H;J++){for(L in I[J]){if(I[J].hasOwnProperty(L)){K[L]=I[J][L]}}}return K}m(f,"__extend",v);function s(I,K,J){var H;for(H in I){(I.hasOwnProperty(H)||J)&&K.call(I,I[H],H)}return I}m(f,"__enum",s);function B(M,I,J,N,L){this.attack=I||50;this.decay=J||50;this.sustain=N||1;this.release=L||50;this.value=0;var P=this,H=3,K=false,O=[function(){P.value+=1000/P.sampleRate/P.attack;if(P.value>=1){H=1}},function(){P.value-=1000/P.sampleRate/P.decay*P.sustain;if(P.value<=P.sustain){H=2}},function(){P.value=P.sustain},function(){P.value=l.max(0,P.value-1000/P.sampleRate/P.release)}];this.generate=function(){O[H]();return this.value};this.triggerGate=function(Q){K=Q;H=K?0:3};this.sampleRate=M}function F(){var P=this,M=[];this.velocity=0;this.legato=0;this.retrigger=0;this.polyphony=1;this.activeKeys=[];this.voices=[];this.pitchBend=0;function N(Q,R){this.key=Q;this.velocity=R;this.noteOff=function(){};this.onKeyChange=function(){};this.changeKey=function(T,S){this.key=T;this.v=S;this.onKeyChange()};this.getFrequency=function(){return P.getFrequencyForKey(this.key)};P.voice.apply(this)}function K(R){var Q;for(Q=0;Q<M.length;Q++){if(M[Q].key===R){M.splice(Q--,1)}}}function O(Q,R){K(Q);M.push({key:Q,velocity:R})}function I(){var Q,S,R=[];if(P.legato===0){R=M.slice(0)}else{if(P.legato===1){for(Q=0;Q<M.length;Q++){for(S=0;S<R.length;S++){if(S===M.length-1||(R[S-1].key>M[Q].key&&R[S].key<M[Q].key)){R.splice(S,0,M[Q]);break}}}}else{if(P.legato===2){for(Q=0;Q<M.length;Q++){for(S=0;S<R.length;S++){if(S===M.length-1||(R[S-1].key<M[Q].key&&R[S].key>M[Q].key)){R.splice(S,0,M[Q]);break}}}}}}P.activeKeys=R.slice(-P.polyphony)}function H(){if(!P.voice){return}var Q,S,R;if(P.polyphony===1&&P.activeKeys.length>0){Q=P.activeKeys.length-1;if(P.voices.length===0){P.voices.push(new N(P.activeKeys[Q].key,P.activeKeys[Q].velocity))}else{P.voices[0].changeKey(P.activeKeys[Q].key,P.activeKeys[Q].velocity)}}else{for(S=0;S<P.activeKeys.length;S++){R=false;for(Q=0;Q<P.voices.length;Q++){if(P.voices[Q].key===P.activeKeys[S].key){R=true;break}}if(!R){P.voices.push(new N(P.activeKeys[Q].key,P.activeKeys[Q].velocity))}}}for(Q=0;Q<P.voices.length;Q++){R=false;for(S=0;S<P.activeKeys.length;S++){if(P.voices[Q].key===P.activeKeys[S].key){R=true;break}}if(!R){P.voices[Q].noteOff();P.voices.splice(Q--,1)}}}function L(R,S){var Q=P.activeKeys.length;O(R,S);I();H();P.onNoteOn(R,S);if(P.retrigger===0||(Q===0&&P.activeKeys.length>0)){P.onTrigger()}}function J(Q,R){K(Q,R);I();H();P.onNoteOff(Q,R);if(P.activeKeys===0){P.onRelease()}}this.onMidi=function(Q){switch(Q.status){case 9:L(Q.data1,Q.data2/127);break;case 8:J(Q.data1,Q.data2/127);break;case 14:P.pitchBend=(Q.data1*128+Q.data2-8192)/8192;break}};this.getFrequencyForKey=function(Q){return 440*l.pow(1.059,Q-69)};this.getFrequency=function(){var R=[],Q;for(Q=0;Q<P.activeKeys.length;Q++){R.push(P.getFrequencyForKey(P.activeKeys[Q].key))}if(R.length>2){return R[0]}return R};this.onTrigger=function(){};this.onRelease=function(){};this.onNoteOn=function(){};this.onNoteOff=function(){};this.voice=null;this.listener=function(Q){P.onMidi(Q)}}function z(L,I,K,M){var J=this,H=0;J.sampleRate=L;J.stepLength=I||200;J.steps=K||[1,0];J.value=0;J.attack=M||0;J.generate=function(){var P=J.sampleRate/1000*J.stepLength,R=J.steps,Q=P*R.length,T,N,O,S,U;if(++H===Q){H=0}T=H/Q*R.length;N=T%1;T=l.floor(T);O=(T||R.length)-1;S=R[T]-R[O];U=R[T];if(N<J.attack){U-=S-S/J.attack*N}J.value=U;return U};J.triggerGate=function(){H=0}}function t(P,H,K,L){var Q=this,J=new e(H),I=H-1,N=K,O=0,M=0;this.volume=Q.volume||1;Q.sampleRate=P;Q.pushSample=function(R){J[N++]=R;M=J[O++]*Q.volume;if(N>=I){N=0}if(O>=I){O=0}return M};Q.getMix=function(){return M}}function b(N,L,I,H,M,K){var J=this,O=0;J.inputs=[0,0];J.outputs=[0,0];J.sampleRate=N;J.coefs={a0:L,a1:I,a2:H,b1:M,b2:K};J.pushSample=function(Q){var S=J.coefs,P=J.inputs,R=J.outputs;O=S.a0*Q+S.a1*P[0]+S.a2*P[1]-S.b1*R[0]-S.b2*R[1];P.pop();P.unshift(Q);R.pop();R.unshift(O);return O};J.getMix=function(){return O};J.reset=function(){J.inputs=[0,0];J.outputs=[0,0]}}b.LowPass=function(T,L,N){var O=2*l.PI*L/T,U=l.cos(O),H=l.sin(O),M=H/(2*N),S=(1-U)/2,R=1-U,P=S,K=1+M,J=-2*U,I=1-M;return new b(T,S/K,R/K,P/K,J/K,I/K)};b.HighPass=function(T,L,N){var O=2*l.PI*L/T,U=l.cos(O),H=l.sin(O),M=H/(2*N),S=(1+U)/2,R=-(1+U),P=S,K=1+M,J=-2*U,I=1-M;return new f.BiquadFilter(T,S/K,R/K,P/K,J/K,I/K)};b.AllPass=function(T,M,N){var O=2*l.PI*M/T,U=l.cos(O),H=l.sin(O),L=H/(2*N),S=1-L,R=-2*U,P=1+L,K=P,J=R,I=S;return new f.BiquadFilter(T,S/K,R/K,P/K,J/K,I/K)};b.BandPass=function(T,J,P){var O=2*l.PI*J/T,U=l.cos(O),H=l.sin(O),M=l.log(2)/2*P*O/H,N=H*(l.exp(M)-l.exp(-M))/2,S=N,R=0,Q=-N,L=1+N,K=-2*U,I=1-N;return new f.BiquadFilter(T,S/L,R/L,Q/L,K/L,I/L)};function G(I,K){var H=this,J=0;H.sampleRate=I;H.resolution=K?l.pow(2,K-1):l.pow(2,8-1);H.pushSample=function(L){J=l.floor(L*H.resolution+0.5)/H.resolution;return J};H.getMix=function(){return J}}function x(O,L,K,H){var P=this,J,I,N;P.delayTime=L||30;P.depth=K||3;P.freq=H||0.1;function M(){J=new e(P.sampleRate*0.1);I=0;var R,Q=J.length;for(R=0;R<Q;R++){J[R]=0}}P.sampleRate=O;P.osc=new d(O,H);P.calcCoeff=M;P.pushSample=function(R){if(++I>=J.length){I=0}J[I]=R;P.osc.generate();var Q=P.delayTime+P.osc.getMix()*P.depth;Q*=P.sampleRate/1000;Q=I-l.floor(Q);while(Q<0){Q+=J.length}N=J[Q];return N};P.getMix=function(){return N};M()}function D(J,I,L){var H=this,K=0;H.sampleRate=J;H.scale=I||1;H.gain=L||0.5;H.pushSample=function(M){M/=H.scale;K=(1+H.gain)*M-H.gain*M*M*M;return K};H.getMix=function(){return K}}function h(J,K,H){var I=this;I.time=isNaN(K)?I.time:K;I.feedback=isNaN(H)?I.feedback:H;I.reset(J)}h.prototype={sampleRate:1,bufferPos:0,buffer:null,time:1000,feedback:0,sample:0,_rstf:1,pushSample:function(J){var I=this,H=I.buffer;H[I.bufferPos++]+=J;if(I.bufferPos>I.time*I._rstf){I.bufferPos=0}I.sample=H[I.bufferPos];H[I.bufferPos]*=I.feedback;return I.sample},getMix:function(){return this.sample},resample:function(J){var H=this,I=H.time/J;H.buffer=f.Sampler.resample(H.buffer,J);H.time=J;H.bufferPos=l.round(I*H.bufferPos);return H.buffer},reset:function(J,M){var H=this,I=H.buffer,K,L;J=isNaN(J)?H.sampleRate:J;L=H.sampleRate/J;H.buffer=new e(J*h.MAX_DELAY);H.bufferPos=l.round(L*H.bufferPos);H._rstf=1/1000*J;if(M){I=f.Sampler.resample(I,L);for(K=0;K<I.length&&K<H.buffer.length;K++){H.buffer[K]=I[K]}}return H.buffer}};h.MAX_DELAY=2;function p(H){var L=new g(H,720.484),K=new g(H,723.431),J=new g(H,1),I=0;this.gain=4;this.master=1;this.sampleRate=H;this.filters=[L,K,J];this.pushSample=function(M){L.pushSample(M);I=L.getMix(1)*this.gain;I=l.atan(I)+I;if(I>0.4){I=0.4}else{if(I<-0.4){I=-0.4}}K.pushSample(I);J.pushSample(K.getMix(0));I=J.getMix(1)*this.master;return I};this.getMix=function(){return I}}(function(I,H){H.Capper=function(K,L){var J=this,M=0;J.sampleRate=K;J.cap=L||1;J.pushSample=function(N){M=N>J.cap?2*J.cap-N:N<-J.cap?-2*J.cap-N:N;return M};J.getMix=function(){return M}};H.Expo=function(K,M){var J=this,L=0;J.sampleRate=K;J.param=M||0.8;J.pushSample=function(N){L=(N<0?-l.pow(J.param*2,-N):l.pow(J.param*2,N))/10;return L};J.getMix=function(){return L}}}(this,f));function g(M,I,T,R){var U=this,O=[0,0,0,0],H,K,S,J,Q=l.sin,L=l.min,N=l.pow;U.cutoff=!I?20000:I;U.resonance=!T?0.1:T;U.samplerate=M;U.type=R||0;function P(){H=2*Q(l.PI*L(0.25,U.cutoff/(U.samplerate*2)));K=L(2*(1-N(U.resonance,0.25)),L(2,2/H-H*0.5))}U.pushSample=function(V){if(S!==U.cutoff||J!==U.resonance){P();S=U.cutoff;J=U.resonance}O[3]=V-K*O[2];O[0]=O[0]+H*O[2];O[1]=O[3]-O[0];O[2]=H*O[1]+O[2];O[3]=V-K*O[2];O[0]=O[0]+H*O[2];O[1]=O[3]-O[0];O[2]=H*O[1]+O[2];return O[U.type]};U.getMix=function(V){return O[V||U.type]}}function a(J,K,L){var H=this,I=[0,0];H.cutoff=!K?20000:K;H.resonance=!L?0:L;H.samplerate=J;H.pushSample=function(N){var M=H.cutoff*2/H.samplerate,O=H.resonance+H.resonance/(1-M);I[0]=I[0]+M*(N-I[0]+O*(I[0]-I[1]));I[1]=I[1]+M*(I[0]-I[1]);return I[1]};H.getMix=function(){return I[1]}}function w(M,J,T){var U=this,R=0,L=0,O=l.PI*2,Q,I,H,P,S,K;U.cutoff=!J?20000:J;U.resonance=!T?1:T;U.samplerate=M;function N(){Q=O*U.cutoff/U.samplerate;I=1-Q/(2*(U.resonance+0.5/(1+Q))+Q-2);H=I*I;P=H+1-2*l.cos(Q)*I}U.pushSample=function(V){if(S!==U.cutoff||K!==U.resonance){N();S=U.cutoff;K=U.resonance}R+=(V-L)*P;L+=R;R*=H;return L};U.getMix=function(){return L};N()}function d(I,J){var H=this;H.frequency=isNaN(J)?440:J;H.waveTable=new e(1);H.sampleRate=I;H.waveShapes=H.waveShapes.slice(0)}(function(J,K,I,H){I=d.prototype={sampleRate:1,frequency:440,phase:0,phaseOffset:0,pulseWidth:0.5,fm:0,waveShape:"sine",_p:0,generate:function(){var L=this,N=+L.frequency,M=L.pulseWidth,O=L.phase;N+=N*L.fm;L.phase=(O+N/L.sampleRate/2)%1;O=(L.phase+L.phaseOffset)%1;L._p=O<M?O/M:(O-M)/(1-M)},getMix:function(){return this[this.waveShape]()},getPhase:function(){return this._p},reset:function(L){this.phase=this._p=isNaN(L)?0:L},setWavetable:function(L){this.waveTable=L;return true},sine:function(){return l.sin(this._p*J)},triangle:function(){return this._p<0.5?4*this._p-1:3-4*this._p},square:function(){return this._p<0.5?-1:1},sawtooth:function(){return 1-this._p*2},invSawtooth:function(){return this._p*2-1},pulse:function(){return this._p<0.5?this._p<0.25?this._p*8-1:1-(this._p-0.25)*8:-1},wavetable:function(){return f.Sampler.interpolate(this.wavetable,this._p*this.wavetable.length)},waveShapes:[]};for(H=0;H<K.length;H++){I[H]=I[K[H]];I.waveShapes.push(I[H])}d.WaveShape=function(M,L){if(L){this.prototype[M]=L}return this.prototype[M]};d.createMixWave=function(M,P){var L=P.length,O,N;return this.WaveShape(M,function(){O=0;for(N=0;N<L;N++){O+=this[P[N].shape]()*P[N].mix}return mix})}}(l.PI*2,["sine","triangle","pulse","sawtooth","invSawtooth","square"]));function c(I,J){var H=this;H.voices=[];H.sampleRate=I;H.pitch=isNaN(J)?440:H.pitch}c.prototype={sampleRate:1,pitch:440,delayStart:0,delayEnd:0,maxVoices:1/0,sampleSize:0,voices:null,sample:null,samples:null,data:null,noteOn:function(M){M=isNaN(M)?this.pitch:M;var I=this,L=M/I.pitch,K=I.sampleRate,N=K*I.delayStart,H=I.sampleSize-K*I.delayEnd,J={f:M,p:N,s:L,l:H};I.voices.push(J);while(I.voices.length>I.maxVoices){H=I.voices.shift();H.onend&&H.onend()}return J},generate:function(){var H=this.voices,I,J;for(I=0;I<H.length;I++){J=H[I];J.p+=J.s;J.p>J.l&&H.splice(I--,1)&&J.onend&&J.onend()}},getMix:function(K){var H=this.voices,J=0,I;K=K||0;if(this.samples[K]){for(I=0;I<H.length;I++){J+=c.interpolate(this.samples[K],H[I].p)}}return J},load:function(L,K){var H=this,I=H.samples=c.splitChannels(L.data,L.channelCount),J;if(K){for(J=0;J<I.length;J++){I[J]=c.resample(I[J],L.sampleRate,H.sampleRate)}}H.sample=L.data;H.samples=I;H.data=L;H.sampleSize=I[0].length}};(function(){function H(I,J){if(I&&J){H[I]=J}else{if(I&&H[I] instanceof Function){c.interpolate=H[I]}}return H[I]}c.interpolation=H;H("linear",function(I,M){var L=l.floor(M),K=L+1,J=M-L;K=K<I.length?K:0;return I[L]*(1-J)+I[K]*J});H("nearest",function(I,J){return J>=I.length-0.5?I[0]:I[l.round(J)]});H("linear")}());c.resample=function(O,H,R,S,J){var N=arguments.length,L=N===2?H:N===3?S/R:S/H*J/R,M=O.length,I=l.ceil(M/L),Q=new e(I),P,K;for(P=0,K=0;P<M;P+=L){Q[K++]=c.interpolate(O,P)}return Q};c.splitChannels=function(I,M){var H=I.length,L=H/M,J=[],K,N;for(K=0;K<M;K++){J[K]=new e(L);for(N=0;N<L;N++){J[K][N]=I[K*M+N]}}return J};c.joinChannels=function(J){var L=J.length,I=J[0].length,H=new e(I*L),K,M;for(K=0;K<L;K++){for(M=0;M<I;M++){H[K+M*L]=J[K][M]}}return H};function A(J,K,I){var H=this;H.notes=[];H.sampleRate=J;H.noteTime=isNaN(K)?250:K;H.noteLength=J*0.001*H.noteTime;H.zero=new e(H.noteLength);H.cb=I}A.prototype={pos:0,looping:false,generate:function(){var H=this,J,I;if((H.pos+=1)===H.noteLength){J=H.notes,I=J.shift();if(H.looping){J.push(I)}H.pos=0;H.cb()}},getMix:function(){var H=this,I=H.notes[0]||H.zero;return I[H.pos]},addNote:function(I){var H=this,L=H.noteLength,K=new e(L),J=0;for(J=0;J<L;J++){K[J]=I(J)}H.notes.push(K)},addBuffer:function(H){this.notes.push(H)},getNoteLength:function(){return this.noteLength},getNoteCount:function(){return this.notes.length-1},setLooping:function(H){this.looping=(typeof H==="undefined")?true:H},reset:function(){this.notes=[];this.pos=0}};(function(H){function M(T){var V,U=T.length,S={};for(V=0;V<U;V++){S[T[V]]=true}return S}var P=M([256,512,1024,2048,4096,8192,16384]),I=M([48000,44100,22050]),R=String.fromCharCode;function Q(X,W,V,U){var T=Q.devices,S;for(S in T){if(T.hasOwnProperty(S)&&T[S].enabled){try{return new T[S](X,W,V,U)}catch(Y){}}}throw"No audio device available."}function J(S){this.boundTo=S;this.buffers=[];S.activeRecordings.push(this)}J.prototype={add:function(S){this.buffers.push(S)},clear:function(){this.buffers=[]},stop:function(){var S=this.boundTo.activeRecordings,T;for(T=0;T<S.length;T++){if(S[T]===this){S.splice(T--,1)}}},join:function(){var W=0,X=0,U=this.buffers,S,Y,V,T=U.length;for(V=0;V<T;V++){W+=U[V].length}S=new e(W);for(V=0;V<T;V++){for(Y=0;Y<U[V].length;Y++){S[X+Y]=U[V][Y]}X+=U[V].length}return S}};function O(S){this.type=S}O.prototype={record:function(){return new J(this)},recordData:function(T){var V=this.activeRecordings,U,S=V.length;for(U=0;U<S;U++){V[U].add(T)}},writeBuffers:function(U){var T=this.buffers,S=U.length,V,X,W,Y;if(T){for(W=0;W<T.length;W++){V=T[W];X=V.length;for(Y=0;Y<S&&Y<X;Y++){U[Y]+=V[Y]}T[W]=V.subarray(Y);W>=X&&T.splice(W--,1)}}},writeBuffer:function(T){var S=this.buffers=this.buffers||[];S.push(T);return S.length}};function N(ac,Z,T,ae){ae=I[ae]?ae:44100;T=P[T]?T:ae/2;var ag=this,V=0,ad=null,ab=new Audio(),aa,Y,X,W,S;function af(am,ai){var al,ak,ah;if(N.backgroundWork){if(window.MozBlobBuilder){ah=new MozBlobBuilder();ah.append('setInterval(function(){ postMessage("tic"); }, '+ai+");");ak=window.URL.createObjectURL(ah.getBlob());al=new Worker(ak);al.onmessage=function(){am()};return function(){al.terminate();window.URL.revokeObjectURL(ak)}}ak=ah=+new Date+"";function aj(an){if(an.source===window&&an.data===ak&&ah<+new Date){ah=+new Date+ai;am()}window.postMessage(ak,"*")}window.addEventListener("message",aj,true);window.postMessage(ak,"*");return function(){window.removeEventListener("message",aj)}}else{al=setInterval(am,ai);return function(){clearInterval(al)}}}function U(){if(ad){aa=ab.mozWriteAudio(ad);V+=aa;if(aa<ad.length){ad=ad.subarray(aa);return ad}ad=null}Y=ab.mozCurrentSampleOffset();X=Number(Y+T*Z-V)+0;if(X>0){W=new e(X);ac&&ac(W,ag.channelCount);ag.writeBuffers(W);ag.recordData(W);aa=ab.mozWriteAudio(W);if(aa<W.length){ad=W.subarray(aa)}V+=aa}}ab.mozSetup(Z,ae);S=af(U,20);this.kill=function(){S()};this.activeRecordings=[];this.sampleRate=ae;this.channelCount=Z;this.type="moz"}N.enabled=true;N.backgroundWork=false;N.prototype=new O("moz");function L(Z,X,V,U){U=I[U]?U:44100;V=P[V]?V:4096;var S=this,W=new (window.AudioContext||webkitAudioContext)(),Y=W.createJavaScriptNode(V,0,X);function T(ah){var aa=ah.outputBuffer,ad=aa.numberOfChannels,af,ac,ae=aa.length,ai=aa.size,ag=new r(ad),ab=new e(ae*ad);for(af=0;af<ad;af++){ag[af]=aa.getChannelData(af)}Z&&Z(ab,ad);S.writeBuffers(ab);S.recordData(ab);for(af=0;af<ae;af++){for(ac=0;ac<ad;ac++){ag[ac][af]=ab[af*ad+ac]}}}Y.onaudioprocess=T;Y.connect(W.destination);this.kill=function(){};this.activeRecordings=[];this.sampleRate=W.sampleRate;this.channelCount=X;this._context=W;this._node=Y;this._callback=T;this.type="webkit"}L.enabled=true;L.prototype=new O("webkit");function K(X,W,V,U){U=I[U]?U:44100;V=P[V]?bufferSize:8192;var S=this,Y;function T(){var Z=new e(V*W);X&&X(Z,S.channelCount);S.writeBuffers(Z);S.recordData(Z)}this.kill=function(){clearInterval(Y)};this.activeRecordings=[];setInterval(T,V/U*1000);this.sampleRate=U;this.channelCount=W;this.type="dummy"}K.enabled=true;K.prototype=new O("dummy");Q.deviceClass=O;Q.propertyEnum=M;Q.devices={moz:N,webkit:L,dummy:K};Q.Recording=J;H.AudioDevice=Q}(this));this.AudioDevice.createScheduled=function(L){var K=[],H=0,I;function J(N,Q){var M=N.length/Q,T=I.chunkSize,P=T*Q,S,O,R;H=+new Date;for(O=0;O<M;O+=T){for(S=0;S<K.length;S++){K[S].t-=T;if(K[S].t<=0){K[S].f.apply(K[S].x,K[S].a);K.splice(S--,1)}}R=O*P;L(N.subarray(R,R+P),Q)}}I=this.apply(this,[J].concat(r.prototype.splice.call(arguments,1)));I.schedule=function(O,N,M){K.push({f:O,x:N,a:M,t:((new Date-H)*0.001*this.sampleRate)})};I.chunkSize=1;return I};(function(){function H(){var J=arguments,I=J.length,L,K;for(K=0;K<I;K++){L=J[K];this.postMessage({type:"injection",code:L instanceof Function?"("+String(L)+").call(this);":L})}}f.AudioWorker=function(K,M){var I=new (window.MozBlobBuilder||window.BlobBuilder)(),J,L;I.append("var audioLib = ("+String(AUDIOLIB)+"(this, Math));\n");M&&I.append('this.addEventListener("message",function(e){e.data&&e.data.type==="injection"&&Function(e.data.code).call(this)}, true);\n');I.append(K instanceof Function?"("+String(K)+").call(this);":K);J=window.URL.createObjectURL(I.getBlob());L=new Worker(J);L._terminate=L.terminate;L.terminate=function(){window.URL.revokeObjectURL(id);return L._terminate.call(L,arguments)};if(M){L.inject=H}return L}}());(function(I,J){var Q=String.fromCharCode,O=true,K=false;function L(R,S){return S?Q(R&255)+L(R>>8,S-1):""}function N(R,S){return S?N(R>>8,S-1)+Q(255-R&255):""}function P(R,S,T){return T?N(R,S):L(R,S)}function H(W,V){var R=W.length,U=R-1,X=0,T=J.pow,S;if(V){for(S=0;S<R;S++){X+=(255-W.charCodeAt(S))*T(256,U-S)}}else{for(S=0;S<R;S++){X+=W.charCodeAt(S)*T(256,S)}}return X}function M(V,aa,U,ad){var Z=J.pow,Y=J.floor,S=M.convertFromBinary,ab=M.convertToBinary,R=V/8,X=Z(2,V),ac=X/2,ae=ac-1,W=1/ac,T=1/ae;return ad?U?aa?function(af,ag){af=Y(af<0?af*ac+X:af*ae);return ab(af,R,ag)}:function(af,ag){return ab(Y(af*ae),R,ag)}:aa?function(af,ag){return ab(af<0?af+X:af,R,ag)}:function(af,ag){return ab(af,R,ag)}:U?aa?function(ah,ag){var af=S(ah,ag);return af>ae?(af-X)*W:af*T}:function(ag,af){return S(ag,af)*T}:aa?function(ah,ag){var af=S(ah,ag);return af>ae?af-X:af}:function(ag,af){return S(ag,af)}}M.convertToBinary=P;M.convertFromBinary=H;M.fromFloat32=M(32,O,O,O);M.toFloat32=M(32,O,O,K);M.fromFloat24=M(24,O,O,O);M.toFloat24=M(24,O,O,K);M.fromFloat16=M(16,O,O,O);M.toFloat16=M(16,O,O,K);M.fromFloat8=M(8,O,O,O);M.toFloat8=M(8,O,O,K);M.fromInt32=M(32,O,K,O);M.toInt32=M(32,O,K,K);M.fromInt16=M(16,O,K,O);M.toInt16=M(16,O,K,K);M.fromInt8=M(8,O,K,O);M.toInt8=M(8,O,K,K);M.fromUint32=M(32,K,K,O);M.toUint32=M(32,K,K,K);M.fromUint16=M(16,K,K,O);M.toUint16=M(16,K,K,K);M.fromUint8=M(8,K,K,O);M.toUint8=M(8,K,K,K);I.Binary=M}(this,l));(function(L,M){function N(O){this.data=O}var K=N.prototype={read:function(P){var O=this,Q=O.data.substr(0,P);O.skip(P);return Q},skip:function(P){var O=this,Q=O.data=O.data.substr(P);O.pointer+=P;return Q.length},readBuffer:function(P,S,U){var Q=this,T="read"+U+S,V=S/8,O=P.length,R=0;while(Q.data&&R<O){P[R++]=Q[T]()}return R}},J,I;function H(R,P,Q){var O=P/8;K["read"+R+P]=function(S){return Q(this.read(O),S)}}for(J in M){I=/to([a-z]+)([0-9]+)/i.exec(J);I&&H(I[1],I[2],M[J])}L.Stream=N;N.newType=H}(this,this.Binary));this.PCMData=(function(H,I){function J(K){return(typeof K==="string"?J.decode:J.encode)(K)}J.decodeFrame=function(N,M,K){if(M===8){var L=new (window.Uint8Array||r)(K.length);(new I(N)).readBuffer(L,8,"Uint");for(M=0;M<K.length;M++){K[M]=(L[M]-127.5)*127.5}}else{(new I(N)).readBuffer(K,M,"Float")}return K};J.encodeFrame=function(P,N){var L=H[(N===8?"fromUint":"fromFloat")+N],K=P.length,O="",M;if(N===8){for(M=0;M<K;M++){O+=L(P[M]*127.5+127.5)}}else{for(M=0;M<K;M++){O+=L(P[M])}}return O};J.decode=function(aj,ai){var N=new I(aj),T=N.read(4),ab=N.readUint32();N=new I(N.read(ab));var Q=N.read(4),S=N.read(4),Z=N.readUint32(),K=new I(N.read(Z)),M=K.readUint16(),ae=K.readUint16(),ah=K.readUint32(),O=K.readUint32(),ag=K.readUint16(),af=ag/ae,R=K.readUint16(),L,V,X,ac,aa,P,ad,Y={},U={channelCount:ae,bytesPerSample:ag/ae,sampleRate:O/ag,chunks:Y,data:aa};function W(){L=N.read(4);V=N.readUint32();ac=N.read(V);P=Y[L]=Y[L]||[];if(L==="data"){X=~~(V/af);aa=U.data=new (typeof e!=="undefined"?e:r)(X);J.decodeFrame(ac,af*8,aa)}else{P.push(ac)}ai&&(N.data?setTimeout(W,1):ai(U))}if(ai){N.data?W():ai(U)}else{while(N.data){W()}}return U};J.encode=function(ac,aa){var W=H.fromUint32,ad=H.fromUint16,T=ac.data,K=ac.sampleRate,O=ac.channelCount||1,Y=ac.bytesPerSample||1,P=Y*8,M=O*Y,Z=K*M,N=T.length,L=N*Y,S=l.pow(2,P-1)-1,R=[],Q="",ab,X,U,V;R.push("fmt "+W(16)+ad(1)+ad(O)+W(K)+W(Z)+ad(M)+ad(P));R.push("data"+W(L)+J.encodeFrame(T,P));V=ac.chunks;if(V){for(X in V){if(V.hasOwnProperty(X)){ab=V[X];for(U=0;U<ab.length;U++){Q=ab[U];R.push(X+W(Q.length)+Q)}}}}R=R.join("");R="RIFF"+W(R.length)+"WAVE"+R;aa&&setTimeout(function(){aa(R)},1);return R};return J}(this.Binary,this.Stream));(function(I,J){var P=J.sin,T=J.cos,S=J.sqrt,N=J.floor,O=J.pow,H=J.ln2,M=J.PI,L=M*2;function K(V,U,W){V.sampleRate=U;V.bufferSize=W;V.bandWidth=0.5*W*U*0.5;V.spectrum=new e(W*0.5);V.real=new e(W);V.imag=new e(W);V.peakBand=V.peak=0;V.getBandFrequency=function(X){return this.bandwidth*X+this.bandwidth*0.5};V.calculateSpectrum=function(){var ah=this,ad=ah.spectrum,ae=ah.real,X=ah.imag,ag=0.5*ah.bufferSize,Y=S,ac=W*0.5,ab,af,aa,Z;for(Z=0;Z<ac;Z++){ab=ae[Z];af=X[Z];aa=ag*Y(ab*ab+af*af);if(aa>ah.peak){ah.peakBand=Z;ah.peak=aa}}}}function R(V,U,W){return new R[V](U,W)}function Q(V,aa){var U=this,Y=aa*aa*0.5,X=new e(Y),Z=new e(Y),W;K(U,V,aa);for(W=0;W<Y;W++){X[W]=P(W*L/aa);Z[W]=T(W*L/aa)}U.forward=function(af){var ak=this,ai=ak.real,ab=ak.imag,ah=ak.bufferSize*0.5,ad=af.length,ag,aj,ae,ac,al;for(ae=0;ae<ah;ae++){ag=aj=0;for(ac=0;ac<ad;ac++){ag+=Z[al=ae*ac]*af[ac];aj+=X[al]*af[ac]}ai[ae]=ag;ab[ae]=aj}return ak.calculateSpectrum()}}I.FourierTransform=R;R.DFT=Q}(this,l));f.ADSREnvelope=B;f.MidiEventTracker=F;f.StepSequencer=z;f.AllPassFilter=t;f.BiquadFilter=b;f.BitCrusher=G;f.Chorus=x;f.Compressor=D;f.Delay=h;f.Distortion=p;f.IIRFilter=g;f.LowPassFilter=a;f.LP12Filter=w;f.Oscillator=d;f.Sampler=c;f.Tracker=A;function o(){}o.prototype={type:"effect",sink:true,source:true,mix:0.5,join:function(){return q.apply(0,[this].concat(r.prototype.splice.call(arguments,0)))}};function q(){var H=r.prototype.splice.call(arguments,0),I=H.prototype=q.prototype;for(i in I){if(I.hasOwnProperty(i)){H[i]=I[i]}}return H}(function(H){q.prototype=H;H.pushSample=function(L){var I=this,K,J;for(J=0;J<I.length;J++){K=I[J].mix;L=I[J].pushSample(L)*K+L*(1-K)}return L}}(new o()));function k(J,I,H){this.channelCount=I;this.effects=[];function K(){J.apply(this,H)}K.prototype=J.prototype;while(I--){this.effects.push(new K())}}k.prototype={mix:0.5,append:function(I){var J=this,L=J.channelCount,H=I.length,K,M;for(K=0;K<H;K+=L){for(M=0;M<L;M++){I[K+M]=J.effects[M].pushSample(I[K+M])*J.mix+I[K+M]*(1-J.mix)}}return I},join:function(){return BufferEffectChain.apply(0,[this].concat(r.prototype.splice.call(arguments,0)))}};function j(){}j.prototype={type:"generator",source:true,mix:1,append:function(K,I,N){var O=this,J=K.length,M=I||1,P=(function(){if(N){return function(Q){K[Q]+=O.getMix()*O.mix}}else{return function(Q){K[Q]=O.getMix()*O.mix}}}()),L,H;for(L=0;L<J;L+=M){O.generate();for(H=0;H<M;H++){P(L+H)}}return K}};(function(K,I){function H(L){return new f.BufferEffect(this,L,[].slice.call(arguments,1))}function J(M,N,L){if(N){L=L||N.prototype;J[M]=N;var O=N.prototype=new o();O.name=O.fxid=M;J[M].createBufferBased=H;for(M in L){if(L.hasOwnProperty(M)){O[M]=L[M]}}}return J[M]}f.effects=J;for(I=0;I<K.length;I++){J(K[I],f[K[I]],f[K[I]].prototype)}}(["AllPassFilter","BiquadFilter","BitCrusher","Chorus","Compressor","Delay","Distortion","IIRFilter","LowPassFilter","LP12Filter"]));(function(J,H){function I(L,M,K){if(M){K=K||M.prototype;I[L]=M;var N=M.prototype=new j();N.name=N.fxid=L;for(L in K){if(K.hasOwnProperty(L)){N[L]=K[L]}}}return I[L]}f.generators=I;for(H=0;H<J.length;H++){I(J[H],f[J[H]],f[J[H]].prototype)}}(["Oscillator","Sampler","Tracker"]));function n(H,I){var J=H[0].toUpperCase()+H.substr(1).toLowerCase();n[H]=I;if(I.decode){f.Sampler.prototype["load"+J]=function(K){this.load.apply(this,[n[H].decode(K)].concat([].slice.call(arguments,1)))}}if(I.encode){f.AudioDevice.Recording.prototype["to"+J]=function(K){return n[H].encode({data:this.join(),sampleRate:this.boundTo.sampleRate,channelCount:this.boundTo.channelCount,bytesPerSample:K})}}return I}n("wav",f.PCMData);f.EffectChain=q;f.EffectClass=o;f.BufferEffect=k;f.GeneratorClass=j;f.codecs=f.Codec=n;f.version="0.4.7";return f}).call(typeof exports==="undefined"?{}:this,this.window||global,Math,Object,Array);